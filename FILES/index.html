<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DATA BASE</title>
    <style>
        @font-face {
            font-family: 'font_1';
            src: url('/fonts/font_1.otf');
        }
        @font-face {
            font-family: 'font_2';
            src: url('/fonts/font_2.otf');
        }
        @font-face {
            font-family: 'font_3';
            src: url('/fonts/font_3.otf');
        }
        @font-face {
            font-family: 'font_4';
            src: url('/fonts/font_4.ttf');
        }
        body {
            margin: 0;
            padding: 0;
            background-color: rgb(22, 22, 22); 
            color: aliceblue;
            text-align: center;
            overflow: hidden;
        }
        .ALL {
            height: 100vh;
            display: flex;
            flex-wrap: wrap;
        }
        .controls {
            width: 55%;
            height: 80%;
            max-width: 550px;
            background-color: rgb(22, 22, 22);
            margin-right: auto;
            border-top-right-radius: 0px;
            border-bottom-right-radius: 20px;
            display: flex;
            flex-direction: column; 
            justify-content: center;
        }
        .intext {
            display: inline;
            width: 37%;
            height: 20px;
            outline: 1px yellow solid;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
            font-size: 15px;
            color:aliceblue;
            background-color: rgb(30, 30, 30);
            border: none;
            margin-left: 10px;
            margin-right: 10px;
        }
        .buttons {
            margin-top: 15px;
            width: 28%;
            height: 30px;
            border-radius: 10px;
            background-color: green;
            color: aliceblue;
            font-size: 15px;
            border-color: blue;
        }
        .clear {
            margin-top: 15px;
            width: 25%;
            height: 30px;
            border-radius: 10px;
            background-color: red;
            color: aliceblue;
            font-size: 15px;
            border-color: blue;
        }
        .console {
            width: 90%;
            height: 100%;
            background: linear-gradient( to top ,rgb(92, 39, 48),rgba(92, 39, 68, 0.767) ,transparent);
            border-bottom-right-radius: 20px;
            overflow-y: scroll;
            scrollbar-color: red transparent;
            margin-top: auto;
            margin-bottom: auto;
            text-align: left;
            padding: 5%;
        }
        .info {
            width: 40%;
            height: 80%;
            max-width: 250px;
            margin-left: auto;
            background: linear-gradient( to top right,rgb(92, 39, 48) ,rgba(92, 39, 68, 0.767) ,transparent);
            border-top-left-radius: 0px;
            border-bottom-left-radius: 20px;
            overflow-x: hidden;
            overflow-y: scroll;
            scrollbar-color: red transparent;
        }
        .vr {
            rotate: 180deg;
            height: 80vh;
            width: 1px;
            background-color: aliceblue;
            margin: 0;
        }
        .inline {
            display: inline;
            font-family: 'font_4', sans-serif;
            letter-spacing: 1px;
        }
        .tabbar {
            width: 98%;
            height: 60px;
            min-width: 80%;
            background: linear-gradient(to right bottom, rgb(92, 39, 48) ,rgba(92, 39, 68, 0.767) ,transparent);
            margin: auto;
        }
        h4 {
            color: green;
            font-family: 'font_3', sans-serif;
        }
        span {white-space: pre;}
        .log {
            width: 80%;
            height: 60%;
            max-width: 400px;
            max-height: 350px;
            background: linear-gradient(to right bottom, rgb(92, 39, 48) ,rgba(92, 39, 68, 0.767) ,transparent);
            margin:50px auto auto auto;
            border-radius: 30px;
            border: 1px white solid;
            overflow: hidden;
            
        }
        .server_data {
            width: 58%;
            max-width: 325px;
            height: 75%;
            background: linear-gradient(to right bottom, rgba(170, 47, 133, 0.829) ,rgba(66, 39, 92, 0.671) ,rgba(92, 39, 46, 0));
            margin: 15px 0 0 auto;
            border-radius: 20px 0 0 20px;
            overflow-x: hidden;
            overflow-y: scroll;
            scrollbar-color: red transparent;
            border: 1px white solid;
        }
        .server_info {
            width: 35%;
            max-width: 200px;
            height: 75%;
            background: linear-gradient(to  bottom, rgba(39, 92, 46, 0.637) ,rgba(92, 39, 68, 0.767) ,transparent);
            margin: 15px auto 0 0;
            border-radius: 0 20px 20px 0;
            overflow-x: hidden;
            overflow-y: scroll;
            scrollbar-color: red transparent;
            border: 1px white solid;
            transition: 1000ms;
        }
        @keyframes dzl {
            0%{transform: rotate(0deg);}
            10%{transform: rotate(-20deg);}
            30%{transform: rotate(20deg);}
            40%{transform: rotate(0deg);}
        }
        .pannel {
            width: 90%;
            height: 150px;
            margin: 7px auto 7px auto;
            background-color: rgba(0,0,0,0.4);
            border-radius: 10px;
            overflow: hidden;
        }
        .tpannelr {
            width: 49%;
            margin: 5px auto 5px auto;
            font-family: 'font_1', sans-serif;
            font-weight: 100;
            height: 10px;
            color: red;
        }
        .tpannelg {
            width: 49%;
            margin: 5px auto 5px auto;
            font-family: 'font_1', sans-serif;
            font-weight: 100;
            height: 10px;
            color: green;
        }
        .cliN {
            font-family: 'font_2' ,sans-serif;
            color: green;
        }
        .cliF {
            font-family: 'font_2' ,sans-serif;
            color: red;
        }
    </style>
</head>
<body>
    <div class="tabbar">
        <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: yellow;margin-right: 5%;" class="buttons" onclick="GET_LOG('server')" value="Server">
        <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: yellow;margin-left: 5%;" class="buttons"   onclick="GET_LOG('data_bases')" value="Data Base">
    </div>
    <hr style="margin: 0;width: 98%;margin-left: auto;margin-right: auto;">
    <div class="ALL" id="ALL">
<!--         <div class="log">
            <h1 style="font-family: font_3, sans-serif;color: green;margin: 10px auto 10px auto;">Data Base</h1>
            <div style="display: flex;flex-wrap: nowrap;height: 100%;">
                <div style="height: 100%;margin-top: 30px;">
                    <input type="text" id="" class="intext" style="width: 75%;height: 7%;font-size: 20px;" placeholder="Data Base">
                    <input type="password" id="" class="intext" style="width: 75%;height: 7%;font-size: 20px;margin-top: 10%;" placeholder="Password">
                    <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: rgb(47, 0, 255);margin-top: 20%;width: 40%;height: 35px;" class="buttons" value="Log in">    
                </div>
                <div style="height: 100%;min-width: 40%;align-items: center;background-color: rgba(0,0,0,0.2);margin-right: 10px;border-radius: 15px;overflow: hidden;">
                    <h4 style="margin: 15px auto 5px auto;color: yellow;">Data Bases</h4>
                    <hr>
                    <div style="display:flex;flex-direction: column;width: 100%;height: 65%;align-items: center;overflow-y: scroll;scrollbar-color: red transparent;">
                        <input type="button" class="buttons" style="width: 90%;background-color: rgba(0, 0, 0, 0.158);border-color: green;" value="islam">
                    </div>
                </div>
            </div>
        </div> -->

<!--         <div class="server_data">
            <h2 style=" font-family: 'font_4', sans-serif; letter-spacing: 3px; color: green;display: inline;margin: 0;font-size: 30px;">islam-<h2 style="font-family: 'font_4', sans-serif;letter-spacing: 3px;animation: dzl 4s linear infinite;display: inline-block;font-size: 30px;color: green;margin:15px 0 10px 0;">DZL</h2></h2>
            <hr>

            <div class="pannel">
                <div style="text-align: end;position: relative;display: flex;flex-wrap: wrap;">
                    <div style="width: 75%;height: auto;text-align: center;overflow-x: scroll;scrollbar-color: transparent,transparent;">
                        <h4 style="margin: 0 0 0 0;padding: 5px 0 5px 10px;color: yellow;font-family: 'font_2', sans-serif;">Islam<dflam</h4>
                    </div>
                    <input type="button"style="margin: auto; color:white; border:none; border-radius:5px;background-color: green;padding: 0px 5px 5px 4px;" value=" . . . ">
                </div>
                <hr style="margin: 0;">
                <div style="display: flex;flex-wrap: wrap;width: 78%;height: auto;background-color: rgba(137, 43, 226, 0);overflow-y: scroll;">
                    <h5 class="tpannelr">State : </h5><h5 class="tpannelg">On</h5>
                    <h5 class="tpannelr">clients : </h5><h5 class="tpannelg">5</h5>
                    <h5 class="tpannelr">client-on : </h5><h5 class="tpannelg">3</h5>
                    <h5 class="tpannelr">Size : </h5><h5 class="tpannelg">12 kb</h5>
                    <h5 class="tpannelr">Type : </h5><h5 class="tpannelg">Json/File</h5>
                    <h5 class="tpannelr">Date : </h5><h5 class="tpannelg">12/5/2024</h5>
                    <hr class="vr" style="transform: translate(0,250px);height: 300px;">
                </div>
                <div style="transform: translate(0, -380px); background-color: rgba(0, 0, 255, 0);width: 100%;text-align: end;">
                    <input type="button" style="margin-right: 1%; padding: 3px; font-family: 'font_1',sans-serif; color: white;background-color: blue; border-radius: 10px;rotate: 90deg;transform: translate(-5px ,-5px);" value="DLoad">
                    <br><br><br>
                    <input type="button" style="margin-right: 1%; padding: 3px; font-family: 'font_1',sans-serif; color: white;background-color: red; border-radius: 10px;rotate: 90deg;transform: translate(-15px ,-7px);" value="Delete">
                </div>
            </div>

        </div>
        <div class="server_info">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" value="Stop Server">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" value="Create Base">
            <hr style="border-color: rgb(92, 39, 48);">
            <div style="display: flex;flex-wrap: wrap;">
                <h5 class="tpannelr" style="color: yellow;">Ping : </h5><h5 class="tpannelg">12</h5>
                <h5 class="tpannelr" style="color: yellow;">All Ping : </h5><h5 class="tpannelg">20</h5>
                <h5 class="tpannelr" style="color: yellow;">Clients : </h5><h5 class="tpannelg">21</h5>
            </div>
            <hr>
            <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;">islam</h3>
            <div style="display: none;">
                <hr>
                <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;">Delete</h3>
                <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Confirm">
                <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Cansels">
                <hr>
            </div>
            <h4 style="color: yellow;">Password</h4>
            <h5 style="font-family: font_1 , sans-serif;letter-spacing: 1px; margin: 0;">islalxxx075</h5>
            <h4 style="color: yellow;">Clients</h4>
            <h5 class="cliN">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
            <h5 class="cliF">islalxxx075</h5>
        </div> -->
        <!--    <div class="log">
            <h1 style="font-family: font_3, sans-serif;color: green;">Server</h1>
            <input type="text" id="" class="intext" style="width: 75%;height: 7%;font-size: 20px;" placeholder="Data Base">
            <input type="password" id="" class="intext" style="width: 75%;height: 7%;font-size: 20px;margin-top: 10%;" placeholder="Password">
            <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: rgb(47, 0, 255);margin-top: 20%;width: 40%;height: 35px;" class="buttons" value="Log in">

        </div> -->
 <!-- 
           <div class="info">
            <h3 style="font-family: 'font_1', sans-serif;font-weight: 100;">ISLAM-DZL</h3>
            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Web Socket States</h5>
            <ul dir="rtl" style="list-style-type: none; padding: 0;">
                <li><h4 class="inline">965452</h4><h5 class="inline"> : running time</h5></li>
                <li><h4 class="inline">True</h4><h5 class="inline"> : connect</h5></li>
                <li><h4 class="inline">96</h4><h5 class="inline"> : Ping</h5></li>
            </ul>            
            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">powers</h5>
            <ul dir="rtl" style="list-style-type: none; padding: 0;">
                <li><h4 class="inline">READ</h4></li>
                <li><h4 class="inline">WRITE</h4></li>
                <li><h4 class="inline">DELETE</h4></li>
                <li><h4 class="inline">EDITE</h4></li>
            </ul>
            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Data Base</h5>
            <h5 style="margin: 5px;">Password</h5>
            <h4 style="margin: 0;">password</h4>
            <h5 style="margin: 5px">Read Password</h5>
            <h4 style="margin: 0;">Read _password</h4>
            <div style="margin-left: 40%;">
                <h5 style="display: inline;">Hidden</h5>
                <input dir="rtl" type="checkbox">
            </div>
            <ul dir="rtl" style="list-style-type: none; padding: 0;">
                <li><h4 class="inline">6</h4><h5 class="inline"> : Clients</h5></li>
            </ul>

            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Edit Data Base</h5>
                <input type="text" id="" class="intext" style="width: 90%; margin: auto; margin-bottom: 10px;" placeholder="New Password">
                <input type="text" id="" class="intext" style="width: 90%; margin: auto; margin-bottom: 5px;" placeholder="New Password Read">
                <input type="button" style="width: auto;margin-top: 10px; background-color: rgba(0, 128, 0, 0.7);" id="in2" class="buttons" value="Update Password">
                <input type="button" style="width: auto;margin-top: 10px; background-color: rgba(0, 128, 0, 0.7);" id="in2" class="buttons" value="Download JSON File">
                <input type="button" style="width: auto;margin-top: 10px; background-color: red;" id="in2" class="buttons" value="Delete Base">

        </div>
        <hr class="vr">
        <div class="controls">
            <div class="inputs">
                <div style="margin-top: 10px;">
                    <h5 style="color: yellow;display: inline;font-family: 'font_1', sans-serif;">Name base</h5>
                    <h4 style="display: inline;">MANE</h4>
                    <hr>
                    <h5 style="color: yellow;display: inline; margin: 0;font-family: 'font_2', sans-serif;">Add / Edit / Delete</h5>
                    <div>
                        <input type="text" id="" class="intext" placeholder="Key">
                        <input type="text" id="" class="intext" placeholder="Value">
                    </div>
                    <div>
                        <input type="button" value="SET" id="in1" class="buttons">
                        <input type="checkbox"><h5 style="display: inline;"> Delete</h5>
                    </div>
                </div>
                <hr>
                <h5 style="color: yellow;display: inline; margin: 0;font-family: 'font_2', sans-serif;">Add / Edit</h5>
                <div>
                    <input type="text" id="" class="intext" placeholder="Key">
                    <input type="text" id="" class="intext" placeholder="Password">
                </div>
                <div>
                    <input type="button" value="GET" id="in2" class="buttons">
                    <input type="checkbox">
                    <h5 style="display: inline;">password</h5>
                </div>
            </div>
            <div>
                <hr>
                <h5 style="color: yellow;margin: 0;font-family: 'font_2', sans-serif;">Console</h5>
                <input type="button" value="scroll" class="clear" id="scroll">
                <input type="button" value="clear" class="clear" id="clear">
                <hr style="border: none;height: 2px; background-color: rgb(92, 39, 48);">
            </div>
            <div class="console" dir="ltr">
                <h1 style="font-family: 'font_1', sans-serif;font-weight: 100;">ISLAM-DZL</h1>
                <h5>islam szefgeqrg er qrzeg qrzge z gqezr gqrezg qzse ze</h5>
                <h5>islam szefgeqrg er qrzeg qrzge z gqezr gqrezg qzse ze</h5>

                <h5>islam</h5>
            </div>
        </div>
  -->
    </div>
    <script>
        const DOM_ALL = document.getElementById('ALL')
        var socket = new WebSocket(`wss://${location.host}`)
        var __THIS_BASE
        var __SAVELOGE = false
        var __PING
        var _PAGE = 'log_server'
        var _TIME = 0
        var __data_base_clients
        var __CONFIG
        setInterval(async()=>{

            try{
                if (socket.readyState == 1 ) {
                    document.getElementById('time').innerText = ['s',_TIME]
                    document.getElementById('web_socket_state').innerText = 'Connect'
                    if (_PAGE == 'server' || _PAGE == 'base') {
                        __PING = Date.now()
                        socket.send(JSON.stringify({
                                data_base:{
                                    ping:'my'    
                                }
                            }))
                    }
                }else{
                    document.getElementById('web_socket_state').innerText = 'Disconnect'
                }
                _TIME ++
            }catch{console.log(socket.readyState)}
        },1000)
        socket.onopen = ()=>{
            MAIN()

            console.log('connection on web socket server')
            console.log('web socket state : ',socket.readyState)
            socket.send(JSON.stringify({
                data_base:{
                    set_domain:{
                        id:String(Math.floor(Math.random()*100000000)),
                        domains:[]
                    }
                }
            }))
        }
        socket.onmessage =async(event)=>{
            const data = JSON.parse(event.data)
            console.log(data)
            if (! data.data_base) {
                console.log('new message ! : ', data)
            }
            switch (true) {
                case (typeof data.login != "undefined"):
                    if (data.login) {
                        if (data.type == 'server') {
                            DOM_ALL.innerHTML = P_SERVER
                            _PAGE = 'server'
                            SAVE_LOG('server')
                            
                        }else if (data.type == 'data_base') {
                            DOM_ALL.innerHTML = P_DATA_BASE
                            _PAGE = 'base'
                            await SAVE_LOG('bases')
                        }
                    }else{window.alert('Error in password')}
                    break;
                case(typeof data.data_base != "undefined"):
                    if (data.data_base.ping) {
                        if (document.getElementById('ping')) {
                        document.getElementById('ping').innerText = Date.now() - __PING 
                    }
                    }
                    break;
                default:
                    if (data.type === _PAGE) {
                        _TIME = data.time
                        if (document.getElementById('name_base')) {
                            document.getElementById('name_base').innerText = data.confige_base.name
                        }
                        if (document.getElementById('clients_server')) {
                            document.getElementById('clients_server').innerText = data.data_base_clients.ALL.length
                        }
                        if (document.getElementById('data_base_clients')) {
                            document.getElementById('data_base_clients').innerText = data.confige_base.clients.length ? data.confige_base.clients.length : 0
                        }
                        if (document.getElementById('data_base_clients_on')) {
                            document.getElementById('data_base_clients_on').innerText = data.clients.length ? data.clients.length : 0
                        }
                        if (document.getElementById('data_base_rin_state')) {
                            document.getElementById('data_base_rin_state').innerText = data.confige_base.rin_state
                        }
                        if (document.getElementById('data_base_password')) {
                            document.getElementById('data_base_password').innerText = data.confige_base.password
                        }
                        if (document.getElementById('data_base_read_password')) {
                            document.getElementById('data_base_read_password').innerText = data.confige_base.read_password
                        }
                        if (data.type == 'server') {
                            __data_base_clients = data.data_base_clients
                            __CONFIG = data.confige
                            document.getElementById('_bases').innerHTML = ''
                            data.confige.data_bases.reverse().forEach((baseName)=>{
                                let keys
                                let size = {}
                                if (data.files_size) {
                                    if (data.files_size[baseName] >= 1024) {
                                        size.type = "KB"
                                        size.size = Math.floor(data.files_size[baseName] / 1024)
                                        if (data.files_size[baseName] % 1024) {
                                            size.fasil = String(data.files_size[baseName] % 1024).slice(0,3)
                                        }
                                    }else if (data.files_size[baseName] / 1024 >= 1024) {
                                        size.type = "MB"
                                        size.size = Math.floor(data.files_size[baseName] / 1024/ 1024)
                                        if (data.files_size[baseName] % 1024) {
                                            size.fasil = String(data.files_size[baseName] / 1024 % 1024).slice(0,3)
                                        }
                                    }else{
                                        size.type = "B"
                                        size.size = data.files_size[baseName]
                                    }
                                }
                                if (data.data_base_clients[baseName]) {
                                    keys = Object.keys(data.data_base_clients[baseName])
                                }
                                if (data.rin) {
                                    document.getElementById('server_rin').style.backgroundColor = 'rgba(0,0,0,0.4)'
                                    document.getElementById('server_rin').value = 'Stop Server'
                                }else{
                                    document.getElementById('server_rin').style.backgroundColor = 'rgba(255,0,0,1)'
                                    document.getElementById('server_rin').value = 'Start Server'
                                }
                                document.getElementById('_bases').innerHTML += `
                                <div class="pannel">
                                    <div style="text-align: end;position: relative;display: flex;flex-wrap: wrap;">
                                        <div style="width: 75%;height: auto;text-align: center;overflow-x: scroll;scrollbar-color: transparent,transparent;">
                                            <h4 style="margin: 0 0 0 0;padding: 5px 0 5px 10px;color: yellow;font-family: 'font_2', sans-serif;" >${baseName}</h4>
                                        </div>
                                        <input type="button"style="margin: auto; color:white; border:none; border-radius:5px;background-color: green;padding: 0px 5px 5px 4px;" onclick="SERVER_BUTTONS('get-info-${baseName}')" value=" . . . ">
                                    </div>
                                    <hr style="margin: 0;">
                                    <div style="display: flex;flex-wrap: wrap;width: 78%;height: auto;background-color: rgba(137, 43, 226, 0);overflow-y: scroll;">
                                        <h5 class="tpannelr">State : </h5><h5 class="tpannelg">${data.confige.safety[baseName].rin_state?'on':'off'}</h5>
                                        <h5 class="tpannelr">clients : </h5><h5 class="tpannelg">${data.confige.safety[baseName].rin_state?data.confige.safety[baseName].clients.length : 0}</h5>
                                        <h5 class="tpannelr">client-on : </h5><h5 class="tpannelg">${data.data_base_clients[baseName] ? keys.length : 0}</h5>
                                        <h5 class="tpannelr">Size : </h5><h5 class="tpannelg">${size.type}${size.size}${size.fasil?','+ size.fasil : ''}</h5>
                                        <h5 class="tpannelr">Type : </h5><h5 class="tpannelg">Json/File</h5>
                                        <h5 class="tpannelr">Date : </h5><h5 class="tpannelg">12/5/2024</h5>
                                        <hr class="vr" style="transform: translate(0,250px);height: 300px;">
                                    </div>
                                    <div style="transform: translate(0, -380px); background-color: rgba(0, 0, 255, 0);width: 100%;text-align: end;">
                                        <input type="button" style="margin-right: 1%; padding: 3px; font-family: 'font_1',sans-serif; color: white;background-color: blue; border-radius: 10px;rotate: 90deg;transform: translate(-5px ,-5px);" onclick="SERVER_BUTTONS('download-base-${baseName}')" value="DLoad">
                                        <br><br><br>
                                        <input type="button" style="margin-right: 1%; padding: 3px; font-family: 'font_1',sans-serif; color: white;background-color: red; border-radius: 10px;rotate: 90deg;transform: translate(-15px ,-7px);" onclick="SERVER_BUTTONS('delete-base-${baseName}')" value="Delete">
                                    </div>
                                </div>`
                            })
                       
                        }

                    }
                    break;
            }
        }
        const MAIN = async()=>{
            if ( !await localStorage.getItem('info')) { 
                await localStorage.setItem('info',JSON.stringify({
                    server:{},
                    data_bases:{}
                }))                
                console.log('saved')
                __Storage = JSON.parse(await localStorage.getItem('info'))
            }
            __Storage = JSON.parse(await localStorage.getItem('info'))
            let __bases = Object.keys(__Storage.data_bases)
            if (__Storage.server.password) {
                LOG_IN('server')
            }else if (__bases.length != 0) {
                GET_LOG('data_bases')
            }else{
                DOM_ALL.innerHTML = P_LOG_SERVER
                _PAGE = 'log_server'
            }
            
        }
        const DATA_BASE_BITTONS = async(button)=>{
            let __Storage = JSON.parse(await localStorage.getItem('info'))
            switch (button) {
                case 'checkbox-password':
                    if (document.getElementById('checkbox-password').checked) {
                        document.getElementById('data_base_password').style =`
                        margin: 0;
                        text-security: disc;
                        -webkit-text-security: disc;
                        `
                        document.getElementById('data_base_read_password').style =`
                        margin: 0;
                        text-security: disc;
                        -webkit-text-security: disc;
                        `
                    }else{
                        document.getElementById('data_base_password').style = `margin: 0;`
                        document.getElementById('data_base_read_password').style = `margin: 0;`
                    }
                    break;
                case 'checkbox-delete':
                    if (document.getElementById('checkbox-delete').checked) {
                        document.getElementById('base-set-value').style.display = 'none'
                    }else{
                        document.getElementById('base-set-value').style.display = 'inline'
                    }
                    break;
                    case 'update-passwords':
                        let new_password = document.getElementById('base-new-password').value
                        let new_read_password = document.getElementById('base-new-read-password').value
                        console.log(__THIS_BASE)
                        socket.send(JSON.stringify({
                            data_base:{
                                admins_base:{
                                password:btoa(__Storage.data_bases[__THIS_BASE].password),
                                base: __THIS_BASE,
                                exec:{
                                    re_password : {read_password:new_read_password, password:new_password}
                                }
                            }
                        }
                        }))
                        __Storage.data_bases[__THIS_BASE].password = atob(new_password)
                        await localStorage.setItem('info',JSON.stringify(__Storage))
                        new_password = ''
                        new_read_password = ''
                        break
                default:
                    break;
            }
        }
        const SERVER_BUTTONS = async(button)=>{
            let __Storage = await JSON.parse(localStorage.getItem('info'))
            const EXECSERVER = (key, command)=>{
                console.log(JSON.parse(`{
                            "data_base":{
                                "admins_server":{
                                    "password": "${btoa(__Storage.server.password)}",
                                    "exec":{
                                        "${key}" :${command}
                                    }
                                }
                            }
                        }`))
                socket.send(`{
                            "data_base":{
                                "admins_server":{
                                    "password": "${btoa(__Storage.server.password)}",
                                    "exec":{
                                        "${key}" :${command}
                                    }
                                }
                            }
                        }`)
            }
            switch (button) {
                case 'rin':
                EXECSERVER('rin_state', document.getElementById('server_rin').value == 'Stop Server' ? false : true)
                    break;
                        
                case 'creat_base':
                    document.getElementById('_bases').innerHTML = `
                        <input type="text" id="creat_base_name" class="intext" style="width: 90%; margin: 10px 0 10px 0; height:28px;" placeholder="Name">
                        <input type="text" id="creat_base_password" class="intext" style="width: 90%; margin: 10px 0 10px 0; height:28px;" placeholder="Password">
                        <input type="text" id="creat_base_red_password" class="intext" style="width: 90%; margin: 10px 0 10px 0; height:28px;" placeholder="Read Password">
                        <input type="button" style="width: 70%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Confirm"onclick="SERVER_BUTTONS('confermi_creat_base')">
                        <input type="button" style="width: 70%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Cansel" onclick="SERVER_BUTTONS('cansel_creat_base')">
                    `
                    break
                case 'cansel_creat_base':
                    EXECSERVER('rin_state' , document.getElementById('server_rin').value == 'Start Server' ? false : true)
                    break
                case 'confermi_creat_base':
                    EXECSERVER("create_base" , `{"name":"${document.getElementById('creat_base_name').value}","password":"${document.getElementById('creat_base_password').value}","red_password":"${document.getElementById('creat_base_red_password').value}"}`)
                    break
                case (button.slice(0, 9) == 'get-info-'? button : ''):
                    let base = button.slice(9, button.length)
                    document.getElementById('info-base').innerHTML = `
                        <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;">${base}</h3>
                        <hr>
                        <h4 style="color: yellow;margin: 5px;">Password</h4>
                        <h5 style="font-family: font_1 , sans-serif;letter-spacing: 1px; margin: 0;">${__CONFIG.safety[base].password}</h5>
                        <h4 style="color: yellow;">Clients</h4>
                    `
                        if (__CONFIG) {
                            __CONFIG.safety[base].clients.forEach((clientD)=>{
                                if (__data_base_clients[base]) {
                                    let IF = __data_base_clients[base].some( cli=> cli.id == clientD)
                                    console.log(IF)
                                    if (IF) {
                                        document.getElementById('info-base').innerHTML += `
                                            <h5 class="cliN">${clientD}</h5>`
                                    }else{
                                        document.getElementById('info-base').innerHTML += `
                                            <h5 class="cliF">${clientD}</h5>`
                                    }
                                }else{
                                    document.getElementById('info-base').innerHTML += `
                                            <h5 class="cliF">${clientD}</h5>`
                                }
                            })
                        }
                    break
                case (button.slice(0, 12) == 'delete-base-'? button : ''):
                    let baseD = button.slice(12, button.length)
                    console.log(baseD)
                    if (baseD == 'cansle') {
                        document.getElementById('info-base').innerHTML = ''
                    }else{
                        document.getElementById('info-base').innerHTML = `
                        <div style="display: block;" id="server_delete_base">
                            <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;">Delete</h3>
                            <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Confirm">
                            <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('delete-base-cansle')" value="Cansel">
                        </div>`

                    }
                    break
                case (button.slice(0, 14) == 'download-base-'? button : ''):
                    let basew = button.slice(14, button.length)
                    console.log(__CONFIG.safety[basew].password ,basew)
                    socket.send(JSON.stringify({
                        data_base:{
                            get:{
                                password:__CONFIG.safety[basew].password,
                                data_base:basew
                            }
                        }
                    }))
                    break
                case 're-password':
                    document.getElementById('_bases').innerHTML = `
                        <input type="text" id="server-re-password" class="intext" style="width: 90%; margin: 10px 0 10px 0; height:28px;" placeholder="new Password">
                        <input type="button" style="width: 70%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Confirm"onclick="SERVER_BUTTONS('confermi-re-password')">
                        <input type="button" style="width: 70%; background-color: rgba(0,0,0,0.4);" class="buttons" value="Cansel" onclick="SERVER_BUTTONS('cansel_creat_base')">
                    `
                    break
                case 'confermi-re-password': 
                    let new_password = document.getElementById('server-re-password').value
                    EXECSERVER({re_password : new_password})
                    let ED__Storage = __Storage
                    ED__Storage.server.password = btoa(new_password)
                    await localStorage.setItem('info', ED__Storage)
                    break
                case 'formate':
                    document.getElementById('info-base').innerHTML = `
                        <div style="display: block;" id="server_delete_base">
                            <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;">Formate</h3>
                            <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('confermi-formate')" value="Confirm">
                            <input type="button" style="width: 90%; background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('delete-base-cansle')" value="Cansel">
                        </div>`
                    break
                case 'confermi-formate':
                    EXECSERVER({formate:atob(__Storage.server.password)})
                    break
                default:
                    break;
            }
        }
        const SAVE_LOG = async(type)=>{
            let __Storage = await JSON.parse(localStorage.getItem('info'))
            let ED__Storage = __Storage
            if (__SAVELOGE) {
                if (type == 'server') {
                    ED__Storage.server = __SAVELOGE
                    await localStorage.setItem('info',JSON.stringify(ED__Storage))
                }else{
                    ED__Storage.data_bases[__SAVELOGE.base] = {}
                    ED__Storage.data_bases[__SAVELOGE.base] = __SAVELOGE[__SAVELOGE.base]
                    console.log(ED__Storage)
                    await localStorage.setItem('info', JSON.stringify(ED__Storage))
                    console.log('saved')
                }
                __SAVELOGE = false
            }
            if (type.slice(0, 7) == 'delete-'){
                console.log(type.slice(7, type.length))
                delete __Storage.data_bases[type.slice(7, type.length)] 
                await localStorage.setItem('info', JSON.stringify(ED__Storage))
                GET_LOG('data_bases')
            }
        }
        const LOG_IN = async(type)=>{
            let __Storage = await JSON.parse(localStorage.getItem('info'))
            switch (type) {
                case 'server':
                    let server_log_password
                    try {
                        server_log_password = document.getElementById('_password_log_server').value
                        __SAVELOGE = {password:await atob(server_log_password)}
                    }catch{}
                    LOG_IN_SERVER(__Storage.server.password ? btoa(__Storage.server.password) : server_log_password)
                    break;
                case 'data_base':
                    let base_log_password = document.getElementById('_base_log_password').value
                    let base_log_name = document.getElementById('_base_log_name').value
                    LOG_IN_BASE({base:base_log_name, password:base_log_password})
                    __SAVELOGE = {[base_log_name]:{password: btoa(base_log_password), name:base_log_name},base:base_log_name}
                    break;

                default:
                    console.log(__Storage.data_bases[type.slice(7, type.length)].password)
                    console.log(btoa(__Storage.data_bases[type.slice(7, type.length)].password))
                        if (type.slice(0, 7) == 'log_in-') {
                            __THIS_BASE = type.slice(7, type.length)
                            LOG_IN_BASE({base:type.slice(7, type.length),password:btoa(__Storage.data_bases[type.slice(7, type.length)].password)})
                        }
                    break;
            }
        }
        const GET_LOG = async(page_name)=>{
            let __Storage = await JSON.parse(localStorage.getItem('info'))
            switch (page_name) {
                case 'server':
                    if (__Storage.server.password) {
                        LOG_IN_SERVER(btoa(__Storage.server.password))
                        return
                    }
                    DOM_ALL.innerHTML = P_LOG_SERVER
                    _PAGE = 'log_server'
                    break
                case 'data_bases':
                    DOM_ALL.innerHTML = P_LOG_DATA_BASE
                    _PAGE = 'log_data_base'
                    let __bases = Object.keys(__Storage.data_bases)
                    if (__bases.length) {
                        document.getElementById('_data_bases').style.display = 'block'
                        document.getElementById('_bases').innerHTML = ''
                        __bases.forEach(base => {
                        document.getElementById('_bases').innerHTML += `
                        <div style="display:flex; flex-direction: row; gap: 0px;">
                            <input type="button" class="buttons" style="width: 90%;background-color: rgba(0, 0, 0, 0.158);border-color: green; border-top-right-radius: 0px; border-bottom-right-radius: 0px;" id="${base}" value="${base}" onclick="LOG_IN('log_in-'+this.id)">
                            <input type="button" class="buttons" style="width: auto;background-color: rgba(0, 0, 0, 0.158);border-color: red;font-size: 10px; border-top-left-radius: 0px; border-bottom-left-radius: 0px;" id="${base}" value="Delete" onclick="SAVE_LOG('delete-'+this.id)">
                        </div>
                        `    
                    });
                    }else{document.getElementById('_data_bases').style.display = 'none'}
                    break
                    default:
                        break
            }
        }
        const LOG_IN_BASE = ({base, password})=>{
            socket.send(JSON.stringify({
                data_base:{
                        admins_base:{
                            password,
                            base,
                            exec:{
                            }
                        }
                    }
            }))
        }
        const LOG_IN_SERVER = (password)=>{
            socket.send(JSON.stringify({
                data_base:{
                    admins_server:{
                        password:password,
                        exec:{}
                    }
                }
            }))
        }
        const P_DATA_BASE = `
        <div class="info">
            <h3 style="font-family: 'font_1', sans-serif;font-weight: 100;">ISLAM-DZL</h3>
            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Web Socket States</h5>
            <ul dir="rtl" style="list-style-type: none; padding: 0;">
                <li><h4 class="inline" id="time"></h4><h5 class="inline"> : running time</h5></li>
                <li><h4 class="inline" id="web_socket_state"></h4><h5 class="inline"> : connect</h5></li>
                <li><h4 class="inline" id="ping"></h4><h5 class="inline"> : Ping</h5></li>
            </ul>            
            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Data Base</h5>
            <ul dir="rtl" style="list-style-type: none; padding: 0;">
                <li><h4 class="inline" id="data_base_rin_state">On</h4><h5 class="inline"> : State</h5></li>
                <li><h4 class="inline" id="data_base_clients">6</h4><h5 class="inline"> : All Clients</h5></li>
                <li><h4 class="inline" id="data_base_clients_on">3</h4><h5 class="inline"> : Clients On</h5></li>
            </ul>
            <h5 style="margin: 5px;font-family: 'font_1', sans-serif;">Password</h5>
            <h4 style="margin: 0;text-security: disc;-webkit-text-security: disc;" id="data_base_password"></h4>
            <h5 style="margin: 5px;font-family: 'font_1', sans-serif;">Read Password</h5>
            <h4 style="margin: 0;text-security: disc;-webkit-text-security: disc;" id="data_base_read_password"></h4>
            <div style="margin-left: 40%;">
                <h5 style="display: inline;">Hidden</h5>
                <input dir="rtl" type="checkbox" checked="true" id="checkbox-password" onclick="DATA_BASE_BITTONS('checkbox-password')">
            </div>

            <hr>
            <h5 style="color: yellow;font-family: 'font_2', sans-serif;">Edit Data Base</h5>
                <input type="text" id="base-new-password" class="intext" style="width: 90%; margin: auto; margin-bottom: 10px;" placeholder="New Password">
                <input type="text" id="base-new-read-password" class="intext" style="width: 90%; margin: auto; margin-bottom: 5px;" placeholder="New Password Read">
                <input type="button" style="width: auto;margin-top: 10px; background-color: rgba(0, 128, 0, 0.7);" class="buttons" onclick="DATA_BASE_BITTONS('update-passwords')" value="Update Password">
                <input type="button" style="width: auto;margin-top: 10px; background-color: rgba(0, 128, 0, 0.7);" class="buttons" onclick="DATA_BASE_BITTONS('download-json-file')" value="Download JSON File">
                <input type="button" style="width: auto;margin-top: 10px; background-color: red;" id="in2" class="buttons" value="Delete Base">

        </div>
        <hr class="vr">
        <div class="controls">
            <div class="inputs">
                <div style="margin-top: 10px;">
                    <h5 style="color: yellow;display: inline;font-family: 'font_1', sans-serif;">Name base</h5>
                    <h4 style="display: inline;" id="name_base"></h4>
                    <hr>
                    <h5 style="color: yellow;display: inline; margin: 0;font-family: 'font_2', sans-serif;">Add / Edit / Delete</h5>
                    <div>
                        <input type="text" id="base-set-key" class="intext" placeholder="Key">
                        <input type="text" id="base-set-value" class="intext" placeholder="Value">
                    </div>
                    <div>
                        <input type="button" value="SET" id="in1" class="buttons">
                        <input type="checkbox" id="checkbox-delete" onclick="DATA_BASE_BITTONS('checkbox-delete')" ><h5 style="display: inline;"> Delete</h5>
                    </div>
                </div>
                <hr>
                <h5 style="color: yellow;display: inline; margin: 0;font-family: 'font_2', sans-serif;">Get</h5>
                <div>
                    <input type="text" id="" class="intext" placeholder="Key">
                </div>
                <div>
                    <input type="button" value="GET" id="in2" class="buttons">
                </div>
            </div>
            <div>
                <hr>
                <h5 style="color: yellow;margin: 0;font-family: 'font_2', sans-serif;">Console</h5>
                <input type="button" value="scroll" class="clear" id="scroll">
                <input type="button" value="clear" class="clear" id="clear">
                <hr style="border: none;height: 2px; background-color: rgb(92, 39, 48);">
            </div>
            <div class="console" dir="ltr">
                <h1 style="font-family: 'font_1', sans-serif;font-weight: 100;">ISLAM-DZL</h1>
                <h5>islam szefgeqrg er qrzeg qrzge z gqezr gqrezg qzse ze</h5>
                <h5>islam szefgeqrg er qrzeg qrzge z gqezr gqrezg qzse ze</h5>

                <h5>islam</h5>
            </div>
        </div>`
        const P_SERVER = `
        <div class="server_data">
            <h2 style=" font-family: 'font_4', sans-serif; letter-spacing: 3px; color: green;display: inline;margin: 0;font-size: 30px;">islam-<h2 style="font-family: 'font_4', sans-serif;letter-spacing: 3px;animation: dzl 4s linear infinite;display: inline-block;font-size: 30px;color: green;margin:15px 0 10px 0;">DZL</h2></h2>
            <hr>    
            <div id="_bases">

            </div>

        </div>
        <div class="server_info">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('rin')" id="server_rin" value="Stop Server">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('creat_base')" value="Create Base">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('re-password')" value="re password">
            <input type="button" style="width: 90%;background-color: rgba(0,0,0,0.4);" class="buttons" onclick="SERVER_BUTTONS('fornate')" value="formate">
            <hr style="border-color: rgb(92, 39, 48);">
            <div style="display: flex;flex-wrap: wrap;">
                <h5 class="tpannelr" style="color: yellow;">Ping : </h5><h5 class="tpannelg" id="ping">12</h5>
                <h5 class="tpannelr" style="color: yellow;">Time : </h5><h5 class="tpannelg" id="time"></h5>
                <h5 class="tpannelr" style="color: yellow;">Clients : </h5><h5 class="tpannelg" id="clients_server">21</h5>
                <h5 class="tpannelr" style="color: yellow;">Statesocet:</h5><h5 class="tpannelg"id="web_socket_state"></h5>
            </div>
            <hr>
            <div id="info-base">
            <h3 style="margin: 0;font-family: 'font_4',sans-serif;letter-spacing: 3px;color: red;"></h3>
            <div style="display: none;" id="server_delete_base">

            </div>
            `
        const P_LOG_SERVER = `
        <div class="log">
            <h1 style="font-family: font_3, sans-serif;color: green;">Server</h1>
            <input type="text" id="_password_log_server" class="intext" style="width: 75%;height: 7%;font-size: 20px;margin-top: 10%;" placeholder="Password">
            <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: rgb(47, 0, 255);margin-top: 20%;width: 40%;height: 35px;" class="buttons" onclick="LOG_IN('server')" value="Log in">`
        const P_LOG_DATA_BASE = `
        <div class="log">
            <h1 style="font-family: font_3, sans-serif;color: green;margin: 10px auto 10px auto;">Data Base</h1>
            <div style="display: flex;flex-wrap: nowrap;height: 100%;">
                <div style="height: 100%;margin-top: 30px;">
                    <input type="text" id="_base_log_name" class="intext" style="width: 75%;height: 7%;font-size: 20px;" placeholder="Data Base">
                    <input type="text" id="_base_log_password" class="intext" style="width: 75%;height: 7%;font-size: 20px;margin-top: 10%;" placeholder="Password">
                    <input type="button" style="background-color: rgba(0,0,0,0.4);border-color: rgb(47, 0, 255);margin-top: 20%;width: 40%;height: 35px;" class="buttons" onclick="LOG_IN('data_base')" value="Log in">    
                </div>
                <div style="height: 100%;min-width: 40%;align-items: center;background-color: rgba(0,0,0,0.2);margin-right: 10px;border-radius: 15px;overflow: hidden;" id="_data_bases">
                    <h4 style="margin: 15px auto 5px auto;color: yellow;">Data Bases</h4>
                    <hr>
                    <div style="display:flex;flex-direction: column;width: 100%;height: 65%;align-items: center;overflow-y: scroll;scrollbar-color: red transparent;" id="_bases">
                    </div>
                </div>
            </div>
        </div>`
    </script>
</body>
</html>
